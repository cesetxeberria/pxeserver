#this task modifies original deb packages because they depend on old packages
---
- name: extract smart-common.deb
  command: dpkg-deb -R /opt/smart/smart-common_10.3.2171.1-1_i386.deb /opt/smart/common
  args:
    warn: no

- name: modify smart-common
  replace:
    dest: /opt/smart/common/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-common
  replace:
    dest: /opt/smart/common/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-common.deb
  command: dpkg-deb -b /opt/smart/common /opt/smart/smart-common.deb
  args:
    warn: no

- name: extract smart-hwr.deb
  command: dpkg-deb -R /opt/smart/smart-hwr_11.3.2121.1-1_i386.deb /opt/smart/hwr
  args:
    warn: no

- name: modify smart-hwr
  replace:
    dest: /opt/smart/hwr/DEBIAN/control
    regexp: '^(.*)Depends:(.*)$'
    replace: 'Depends:'

- name: build new smart-hwr.deb
  command: dpkg-deb -b /opt/smart/hwr /opt/smart/smart-hwr.deb
  args:
    warn: no

- name: extract smart-language.deb
  command: dpkg-deb -R /opt/smart/smart-languagesetup_2.2.2060.4-1_i386.deb /opt/smart/language
  args:
    warn: no

- name: modify smart-language
  replace:
    dest: /opt/smart/language/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-language
  replace:
    dest: /opt/smart/language/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-language.deb
  command: dpkg-deb -b /opt/smart/language /opt/smart/smart-language.deb
  args:
    warn: no

- name: extract smart-drivers.deb
  command: dpkg-deb -R /opt/smart/smart-product-drivers_11.3.2121.1-1_i386.deb /opt/smart/drivers
  args:
    warn: no

- name: modify smart-drivers
  replace:
    dest: /opt/smart/drivers/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-drivers
  replace:
    dest: /opt/smart/drivers/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-drivers.deb
  command: dpkg-deb -b /opt/smart/drivers /opt/smart/smart-drivers.deb
  args:
    warn: no

- name: extract smart-activation.deb
  command: dpkg-deb -R /opt/smart/smart-activation_1.1.2066.1-1_i386.deb /opt/smart/activation
  args:
    warn: no

- name: modify smart-activation
  replace:
    dest: /opt/smart/activation/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-activation
  replace:
    dest: /opt/smart/activation/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-activation.deb
  command: dpkg-deb -b /opt/smart/activation /opt/smart/smart-activation.deb
  args:
    warn: no

- name: extract smart-gallery.deb
  command: dpkg-deb -R /opt/smart/smart-gallerysetup_1.3.6235.1-1_i386.deb /opt/smart/gallery
  args:
    warn: no

- name: modify smart-gallery
  replace:
    dest: /opt/smart/gallery/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-gallery
  replace:
    dest: /opt/smart/gallery/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-gallery.deb
  command: dpkg-deb -b /opt/smart/gallery /opt/smart/smart-gallery.deb
  args:
    warn: no

- name: extract smart-notebook.deb
  command: dpkg-deb -R /opt/smart/smart-notebook_11.0.7511.0-1_i386.deb /opt/smart/notebook
  args:
    warn: no

- name: modify smart-notebook
  replace:
    dest: /opt/smart/notebook/DEBIAN/control
    regexp: 'libcurl3'
    replace: 'libcurl4'

- name: modify smart-notebook
  replace:
    dest: /opt/smart/notebook/DEBIAN/control
    regexp: 'libnspr4-0d'
    replace: 'libnspr4'

- name: build new smart-notebook.deb
  command: dpkg-deb -b /opt/smart/notebook /opt/smart/smart-notebook.deb
  args:
    warn: no
